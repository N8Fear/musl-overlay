--- refpolicy.orig/policy/modules/apps/skype.te	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/skype.te	2011-01-07 23:27:29.287000094 +0100
@@ -0,0 +1,45 @@
+policy_module(skype, 1.0.0)
+
+############################
+# 
+# Declarations
+#
+
+
+type skype_t;
+type skype_exec_t;
+typealias skype_t alias { user_skype_t staff_skype_t sysadm_skype_t };
+application_domain(skype_t, skype_exec_t)
+
+type skype_home_t;
+typealias skype_home_t alias { user_skype_home_t staff_skype_home_t sysadm_skype_home_t };
+userdom_user_home_content(skype_home_t)
+
+############################
+#
+# Local policy
+#
+
+# Looks as if the binary needs this; for the time being use the tunable policy
+tunable_policy(`allow_execmem',`
+	allow skype_t self:process { execmem };
+')
+
+# Manage ~/.Skype
+manage_dirs_pattern(skype_t, skype_home_t, skype_home_t)
+manage_files_pattern(skype_t, skype_home_t, skype_home_t)
+manage_lnk_files_pattern(skype_t, skype_home_t, skype_home_t)
+userdom_user_home_dir_filetrans(skype_t, skype_home_t, dir)
+userdom_search_user_home_dirs(skype_t)
+
+# Be able to call skype from a terminal (debugging)
+userdom_use_user_terminals(skype_t)
+domain_use_interactive_fds(skype_t)
+
+corecmd_exec_bin(skype_t)
+corecmd_exec_shell(skype_t)
+can_exec(skype_t, skype_exec_t)
+#exec_files_pattern(skype_t, skype_exec_t, skype_exec_t)
+libs_use_ld_so(skype_t)
+files_read_usr_symlinks(skype_t)
+
--- refpolicy.orig/policy/modules/apps/skype.if	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/skype.if	2011-01-07 23:28:40.173000111 +0100
@@ -0,0 +1,30 @@
+## <summary>Policy for skype</summary>
+
+#######################################
+## <summary>
+##      Role access for skype
+## </summary>
+## <param name="role">
+##      <summary>
+##      Role allowed access
+##      </summary>
+## </param>
+## <param name="domain">
+##      <summary>
+##      User domain for the role
+##      </summary>
+## </param>
+#
+interface(`skype_role',`
+  gen_require(`
+    type skype_t, skype_exec_t;
+  ')
+
+  role $1 types skype_t;
+
+  domain_auto_trans($2, skype_exec_t, skype_t)
+  ps_process_pattern($2, skype_t)
+  allow $2 skype_t:process signal;
+  allow skype_t $2:process { sigchld signull };
+  allow skype_t $2:fd { use };
+')
--- refpolicy.orig/policy/modules/apps/skype.fc	1970-01-01 01:00:00.000000000 +0100
+++ refpolicy/policy/modules/apps/skype.fc	2011-01-07 21:46:47.603999891 +0100
@@ -0,0 +1,3 @@
+/usr/bin/skype         -- gen_context(system_u:object_r:skype_exec_t,s0)
+/opt/skype/skype       -- gen_context(system_u:object_r:skype_exec_t,s0)
+HOME_DIR/\.Skype(/.*)?    gen_context(system_u:object_r:skype_home_t,s0)
